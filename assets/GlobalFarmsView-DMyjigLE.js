import{_,r as g,d as M,A,e as B,c as w,a as h,t as L,f as z,o as b}from"./index-DEXYa4-s.js";const D={class:"global-farms-view"},W={class:"map-container",id:"container",ref:"mapContainer"},E={key:0,class:"loading-overlay"},I={class:"loading-text"},P={__name:"GlobalFarmsView",setup(G){const f=g(!0),c=g("正在加载地图..."),r={asia:[{coordinates:[121.4737,31.2304],count:35,name:"上海示范农场"},{coordinates:[139.6917,35.6895],count:30,name:"东京智能农场"},{coordinates:[103.8198,1.3521],count:25,name:"新加坡生态园"},{coordinates:[77.209,28.6139],count:28,name:"新德里农业基地"},{coordinates:[114.1095,22.3964],count:26,name:"香港科技农场"}],europe:[{coordinates:[2.3522,48.8566],count:32,name:"巴黎现代农场"},{coordinates:[-.1276,51.5074],count:29,name:"伦敦智慧农场"},{coordinates:[13.405,52.52],count:27,name:"柏林生态基地"},{coordinates:[12.4964,41.9028],count:24,name:"罗马有机农场"},{coordinates:[4.9041,52.3676],count:23,name:"阿姆斯特丹温室"}],northAmerica:[{coordinates:[-74.0059,40.7128],count:34,name:"纽约科技农场"},{coordinates:[-118.2437,34.0522],count:31,name:"洛杉矶绿色基地"},{coordinates:[-79.3832,43.6532],count:28,name:"多伦多智能农场"},{coordinates:[-123.1207,49.2827],count:26,name:"温哥华生态园"},{coordinates:[-112.074,33.4484],count:25,name:"凤凰城沙漠农场"}],southAmerica:[{coordinates:[-46.6333,-23.5505],count:28,name:"巴西圣保罗农场"},{coordinates:[-58.3816,-34.6037],count:24,name:"阿根廷布宜诺斯艾利斯农场"},{coordinates:[-70.6483,-33.4489],count:20,name:"智利圣地亚哥农场"}],oceania:[{coordinates:[151.2093,-33.8688],count:32,name:"澳大利亚悉尼农场"},{coordinates:[174.7633,-36.8485],count:18,name:"新西兰奥克兰农场"}],africa:[{coordinates:[18.4241,-33.9249],count:22,name:"南非开普敦农场"},{coordinates:[36.8219,-1.2921],count:26,name:"肯尼亚内罗毕农场"},{coordinates:[-7.5898,33.5731],count:19,name:"摩洛哥卡萨布兰卡农场"}]},l=[...r.asia,...r.europe,...r.northAmerica,...r.southAmerica,...r.oceania,...r.africa];let o=null,n=null;const v=()=>{const t=document.createElement("link");t.rel="preload",t.as="script",t.href="https://webapi.amap.com/maps?v=2.0&key=d2697917d978cf60cd3eb519c290c760",document.head.appendChild(t)};return M(async()=>{try{v(),c.value="正在加载地图资源...";const t=await A.load({key:"d2697917d978cf60cd3eb519c290c760",version:"2.0",plugins:["AMap.Scale","AMap.ToolBar","AMap.ControlBar","AMap.InfoWindow","AMap.DistrictLayer"],Loca:{version:"2.0.0"}});c.value="正在初始化地图...",o=new t.Map("container",{zoom:3,center:[20,0],viewMode:"3D",mapStyle:"amap://styles/dark",showLabel:!1,pitch:45,rotation:0,showBuildingBlock:!1,features:["bg","point","road"],preloadMode:!0,fadeOnZoom:!1,defaultCursor:"pointer"});const u=new t.DistrictLayer.World({zIndex:5,styles:{"nation-stroke":"#22ffff","coastline-stroke":"#22ffff",fill:"transparent","nation-stroke-width":1,"coastline-stroke-width":1,"nation-stroke-opacity":.8}});o.add(u),o.addControl(new t.Scale),o.addControl(new t.ToolBar({position:{top:"20px",right:"20px"}}));const F=new t.ControlBar({position:{top:"80px",right:"20px"},showZoomBar:!1,showControlButton:!0});o.addControl(F),c.value="正在创建可视化图层...";const d=window.Loca;n=new d.Container({map:o,animate:!1});const s=new d.ScatterLayer({container:n,zIndex:10,opacity:1,visible:!0,zooms:[2,22],blend:"normal"}),x={type:"FeatureCollection",features:l.map(e=>({type:"Feature",properties:{name:e.name,count:e.count,value:e.count},geometry:{type:"Point",coordinates:e.coordinates}}))},k=new d.GeoJSONSource({data:x});s.setSource(k),s.setStyle({unit:"px",size:function(e){return e&&e.properties&&typeof e.properties.count=="number"?e.properties.count/1.5:15},color:"#FF8C00",borderWidth:2,borderColor:"#FFFAF0",opacity:.9,blend:"lighter"});const p=new d.LinkLayer({container:n,zIndex:9,opacity:.8,visible:!0,zooms:[2,22],depth:!0}),y=[];for(let e=0;e<l.length;e++)for(let a=e+1;a<l.length;a++)Math.random()<.2&&y.push({coordinates:[l[e].coordinates,l[a].coordinates]});const C=new d.GeoJSONSource({data:{type:"FeatureCollection",features:y.map(e=>({type:"Feature",properties:{},geometry:{type:"LineString",coordinates:e.coordinates}}))}});p.setSource(C),p.setStyle({unit:"px",lineWidth:2,opacity:.6,color:"#00FFFF",height:[0,300],blend:"lighter"}),n.add(s),n.add(p),await new Promise(e=>{o.on("complete",e)});const m=r.africa,S=new t.Bounds([Math.min(...m.map(e=>e.coordinates[0]))-10,Math.min(...m.map(e=>e.coordinates[1]))-10],[Math.max(...m.map(e=>e.coordinates[0]))+10,Math.max(...m.map(e=>e.coordinates[1]))+10]);o.setBounds(S),setTimeout(()=>{o.setStatus({animateEnable:!0,jogEnable:!0}),o.setPitch(45),o.setRotation(0)},100),setTimeout(()=>{s.setStyle({unit:"px",size:function(e){if(e&&e.properties&&typeof e.properties.count=="number"){const a=e.properties.count/1.5;return[a*.8,a*1.2]}return[12,15]},color:"#FF8C00",borderWidth:2,borderColor:"#FFFAF0",opacity:.9,blend:"lighter",animation:{enable:!0,duration:2e3,easing:"linear",opacity:[.7,1]}}),p.setStyle({unit:"px",lineWidth:1,opacity:.4,color:"#FFA500",height:[0,300],blend:"lighter",animation:{enable:!0,duration:3e3,easing:"linear",opacity:[.2,.4],height:[200,400]}}),n.animate.start(),f.value=!1},500);let i=null;s.on("mousemove",e=>{const a=e.rawData;i&&i.close(),i=new t.InfoWindow({content:`
          <div style="padding: 12px; background: rgba(0, 0, 0, 0.8); border-radius: 4px; min-width: 150px;">
            <h4 style="margin: 0 0 8px; color: #fff; font-size: 16px;">${a.properties.name}</h4>
            <p style="margin: 0; color: #00ffff; font-size: 14px;">规模指数: ${a.properties.value}</p>
          </div>
        `,offset:new t.Pixel(0,-20),closeWhenClickMap:!0}),i.open(o,a.geometry.coordinates)}),s.on("click",e=>{const a=e.rawData;o.setStatus({animateEnable:!0,jogEnable:!0}),o.setZoomAndCenter(4,a.geometry.coordinates,!1,1e3),o.setPitch(60),o.setRotation(-45)}),o.on("click",()=>{i&&(i.close(),i=null)}),o.on("dblclick",()=>{o.setStatus({animateEnable:!0,jogEnable:!0}),o.setZoomAndCenter(2,[40,0],!1,1e3),o.setPitch(35),o.setRotation(0)})}catch(t){console.error("Failed to load map:",t),f.value=!1,c.value="地图加载失败，请刷新重试"}}),B(()=>{n&&(n.animate.stop(),n.destroy()),o&&o.destroy()}),(t,u)=>(b(),w("div",D,[h("div",W,[f.value?(b(),w("div",E,[u[0]||(u[0]=h("div",{class:"loading-spinner"},null,-1)),h("div",I,L(c.value),1)])):z("",!0)],512)]))}},N=_(P,[["__scopeId","data-v-0ce1dddf"]]);export{N as default};
